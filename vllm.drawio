<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36" version="28.0.6">
  <diagram name="Page-1" id="GXyGxh3fhqGWcaT-Y3ZY">
    <mxGraphModel dx="2066" dy="1103" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="sT55y12rGX_XL4kx0Qpv-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="sT55y12rGX_XL4kx0Qpv-1" target="sT55y12rGX_XL4kx0Qpv-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-23" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;dashed=1;dashPattern=8 8;" parent="1" source="sT55y12rGX_XL4kx0Qpv-1" target="sT55y12rGX_XL4kx0Qpv-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-1" value="llm.py-&gt;__init__()&#xa;# Create the Engine (autoselects V0 vs V1)&#xa;self.llm_engine = LLMEngine.from_engine_args(&#xa;Â  Â  Â  Â  Â  Â  engine_args=engine_args, usage_context=UsageContext.LLM_CLASS)" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="240" y="120" width="320" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="sT55y12rGX_XL4kx0Qpv-3" target="sT55y12rGX_XL4kx0Qpv-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-3" value="VLLMçš„å…¥å£åœ¨ vllm/entrypointsä¸‹é¢" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;strokeColor=default;dashed=1;dashPattern=8 8;" parent="1" vertex="1">
          <mxGeometry x="40" y="120" width="150" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="sT55y12rGX_XL4kx0Qpv-6" target="sT55y12rGX_XL4kx0Qpv-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-6" value="test_vllm.py -&amp;gt; main()&lt;div&gt;&amp;nbsp; llm=LLM(model=model_path,)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="240" y="40" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;" parent="1" source="sT55y12rGX_XL4kx0Qpv-8" target="sT55y12rGX_XL4kx0Qpv-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-8" value="&lt;div&gt;#V0 Path&lt;/div&gt;llm_engine.py-&amp;gt;from_engine_args()&lt;br&gt;&amp;nbsp; &amp;nbsp; return engine_cls.from_vllm_config()" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="240" y="230" width="320" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;" parent="1" source="sT55y12rGX_XL4kx0Qpv-10" target="sT55y12rGX_XL4kx0Qpv-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-10" value="llm_engine.py-&amp;gt;from_vllm_config()&lt;br&gt;&amp;nbsp; &amp;nbsp; return cls(&lt;div&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;executor_class=cls._get_executor_cls(vllm_config),&amp;nbsp;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;)&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="240" y="300" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;" parent="1" source="sT55y12rGX_XL4kx0Qpv-12" target="sT55y12rGX_XL4kx0Qpv-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Y6s4YUltKjXgeL2X_BUD-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="sT55y12rGX_XL4kx0Qpv-12" target="Y6s4YUltKjXgeL2X_BUD-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-12" value="llm_engine.py-&amp;gt;__init__()&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.tokenizer = self._init_tokenizer()&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.detokenizer = Detokenizer(self.tokenizer)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.input_preprocessor = InputPreprocessor(self.model_config,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.tokenizer,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; mm_registry)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.model_executor = &lt;b&gt;executor_class&lt;/b&gt;(vllm_config=vllm_config)&lt;br&gt;&#x9;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;self.&lt;b&gt;_initialize_kv_caches&lt;/b&gt;()" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="200" y="400" width="400" height="150" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;" parent="1" source="sT55y12rGX_XL4kx0Qpv-14" target="sT55y12rGX_XL4kx0Qpv-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-14" value="executor_base.py-&amp;gt;__init__()&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._init_executor()" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="240" y="580" width="320" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;" parent="1" source="sT55y12rGX_XL4kx0Qpv-16" target="sT55y12rGX_XL4kx0Qpv-18" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-16" value="mp_distributed_executor.py-&amp;gt;self._init_executor()&lt;div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;init_worker&quot;, all_kwargs)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;init_device&quot;)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;load_model&quot;,&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="240" y="650" width="320" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=12;fontColor=default;dashed=1;dashPattern=8 8;" parent="1" source="sT55y12rGX_XL4kx0Qpv-18" target="sT55y12rGX_XL4kx0Qpv-24" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-18" value="worker.py-&amp;gt;__init__()&lt;br&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;init_worker&quot;, all_kwargs)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;init_device&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;load_model&quot;,&lt;/b&gt;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.model_runner: GPUModelRunnerBase = ModelRunnerClass(&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; vllm_config=self.vllm_config,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; kv_cache_dtype=self.cache_config.cache_dtype,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; is_driver_worker=is_driver_worker,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; **speculative_args,&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; )&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; # initialize_cache.&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.cache_engine: List[CacheEngine]&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; # Initialize gpu_cache as pooling models don&#39;t initialize kv_caches&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self.gpu_cache: Optional[List[List[torch.Tensor]]] = None" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="200" y="760" width="400" height="220" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-22" value="&amp;nbsp; &amp;nbsp; A[ç”¨æˆ·åˆ›å»ºLLMå®žä¾‹] --&amp;gt; B[è°ƒç”¨LLMEngine.from_engine_args]&lt;br&gt;&amp;nbsp; &amp;nbsp; B --&amp;gt; C{æ£€æŸ¥envs.VLLM_USE_V1}&lt;br&gt;&amp;nbsp; &amp;nbsp; C --&amp;gt;|True é»˜è®¤| D[å¯¼å…¥V1LLMEngine]&lt;br&gt;&amp;nbsp; &amp;nbsp; C --&amp;gt;|False| E[ä½¿ç”¨V0LLMEngine]&lt;br&gt;&lt;br&gt;ç³»ç»Ÿé»˜è®¤æ˜¯1ï¼Œä½†ä¼šç”¨å‡½æ•°æ£€æŸ¥&lt;br&gt;_is_v1_supported_oracleï¼ˆï¼‰&lt;div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; if (current_platform.is_cuda()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; and current_platform.get_device_capability()&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; and current_platform.get_device_capability().major &amp;lt; 8):&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; _raise_or_fallback(feature_name=&quot;Compute Capability &amp;lt; 8.0&quot;,&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;recommend_to_remove=False)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; return False&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;dashed=1;dashPattern=8 8;" parent="1" vertex="1">
          <mxGeometry x="620" y="57.5" width="380" height="205" as="geometry" />
        </mxCell>
        <mxCell id="sT55y12rGX_XL4kx0Qpv-24" value="&lt;div&gt;# åœ¨V1ä¸­ï¼Œæœ€ç»ˆä¹Ÿä¼šèµ°åˆ°ç±»ä¼¼çš„åœ°æ–¹ï¼š&lt;/div&gt;mp_distributed_executor.py-&amp;gt;_init_excutor()&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;init_worker&quot;, all_kwargs)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;init_device&quot;)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; self._run_workers(&quot;load_model&quot;," style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;dashed=1;dashPattern=8 8;" parent="1" vertex="1">
          <mxGeometry x="650" y="760" width="280" height="90" as="geometry" />
        </mxCell>
        <mxCell id="Y6s4YUltKjXgeL2X_BUD-1" value="&lt;b style=&quot;forced-color-adjust: none; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(236, 236, 236); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;executor_class&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="410" y="550" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Y6s4YUltKjXgeL2X_BUD-2" value="llm_engine.py-&amp;gt;&lt;b&gt;_initialize_kv_caches&lt;/b&gt;()&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&amp;nbsp;self.model_executor.determine_num_available_blocks())&lt;br&gt;&#x9;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;self.model_executor.initialize_cache(num_gpu_blocks, num_cpu_blocks)" style="rounded=0;whiteSpace=wrap;html=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="610" y="580" width="450" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Y6s4YUltKjXgeL2X_BUD-4" value="&lt;b style=&quot;forced-color-adjust: none; color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(236, 236, 236); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;_initialize_kv_caches&lt;/b&gt;" style="text;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="650" y="480" width="150" height="40" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="FvFLSkKqpKLTtvr1RCym-1" target="FvFLSkKqpKLTtvr1RCym-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-1" value="LLM Entryponts" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1040" y="330" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="FvFLSkKqpKLTtvr1RCym-2" target="FvFLSkKqpKLTtvr1RCym-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-2" value="Generate" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1040" y="420" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-3" target="FvFLSkKqpKLTtvr1RCym-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-3" target="FvFLSkKqpKLTtvr1RCym-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-3" value="EngineCore Client" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1220" y="360" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-6" target="FvFLSkKqpKLTtvr1RCym-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-6" value="ZeroMQ" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1390" y="325" width="80" height="130" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-11" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-8" target="FvFLSkKqpKLTtvr1RCym-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-8" target="FvFLSkKqpKLTtvr1RCym-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-8" value="EngineCore" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1520" y="360" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-12" target="FvFLSkKqpKLTtvr1RCym-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-17" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-12" target="FvFLSkKqpKLTtvr1RCym-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-12" value="Executor" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1520" y="500" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-20" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-14" target="FvFLSkKqpKLTtvr1RCym-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" parent="1" source="FvFLSkKqpKLTtvr1RCym-14" target="FvFLSkKqpKLTtvr1RCym-23" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-14" value="Worker" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1430" y="610" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="FvFLSkKqpKLTtvr1RCym-16" target="FvFLSkKqpKLTtvr1RCym-21" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-16" value="Worker" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1610" y="610" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-18" value="..." style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1550" y="625" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;dashPattern=8 8;" edge="1" parent="1" source="FvFLSkKqpKLTtvr1RCym-19" target="mGCUkn8bLk5gTM7kcdC7-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="FvFLSkKqpKLTtvr1RCym-19" target="mGCUkn8bLk5gTM7kcdC7-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-19" value="Model Runder" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1430" y="700" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="FvFLSkKqpKLTtvr1RCym-21" target="mGCUkn8bLk5gTM7kcdC7-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-21" value="Model Runer" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="1610" y="700" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="FvFLSkKqpKLTtvr1RCym-23" value="æ¯ä¸ªWorkeréƒ½å¯¹åº”ä¸€ä¸ªGPUã€‚&lt;div&gt;å…¨å±€GPUæ€»æ•°æ”¾åœ¨world_sizeå½“ä¸­ï¼Œæ²¡ä¸ªworkeræœ‰ä¸ªrankå€¼ä½œä¸ºè‡ªå·±çš„æ ‡è¯†ï¼Œrank 0ä½œä¸ºå¹¶è¡Œè®¡ç®—æ€»è°ƒåº¦&lt;/div&gt;&lt;div&gt;_WOLRDä½œä¸ºå…¨å±€å˜é‡ä¿å­˜GPUä¿¡æ¯&lt;/div&gt;&lt;div&gt;_TPå’Œ_PPä¿å­˜tpå’Œppå¹¶è¡Œçš„åˆ†ç»„ä¿¡æ¯&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;dashPattern=8 8;align=left;" parent="1" vertex="1">
          <mxGeometry x="1120" y="580" width="240" height="108.75" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-1" value="Model Runderä¸­çš„execute_modelå‡½æ•°è°ƒç”¨self.attn_state.begin_forward(model_input)è¿›è¡ŒæŽ¨ç†ã€‚attn_stateæ˜¯attendçš„åŽç«¯ï¼Œåœ¨vllmä¸­å°±æ˜¯flashattention ï¼ˆå¯¹äºŽè¾ƒè€çš„æž¶æž„ï¼Œä¾‹å¦‚T4, åŽç«¯ä¸ºXFORMERS)" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;dashPattern=8 8;align=left;" vertex="1" parent="1">
          <mxGeometry x="1120" y="710" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="mGCUkn8bLk5gTM7kcdC7-3" target="mGCUkn8bLk5gTM7kcdC7-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-3" value="Model Executor" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1430" y="800" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="mGCUkn8bLk5gTM7kcdC7-5" target="mGCUkn8bLk5gTM7kcdC7-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-5" value="Model Executor" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1610" y="800" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="mGCUkn8bLk5gTM7kcdC7-7" target="mGCUkn8bLk5gTM7kcdC7-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-7" value="QWen2.5_vl" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1430" y="890" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-9" value="QWen2.5_vl" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="1610" y="890" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-11" value="æ¯ä¸ªæ¨¡åž‹éƒ½éœ€è¦å®žçŽ°è‡ªå·±çš„executorï¼Œé‡Œé¢éœ€è¦å®šä¹‰ load_weights() å’Œ forward() å‡½æ•°&#xa;â€Œæ¨¡åž‹åŠ è½½â€Œï¼š&#xa;Executorè°ƒç”¨worker.load_model()Â â†’ Workerè§¦å‘model_runner.load_model()Â â†’Â model_runnerä½¿ç”¨model_executorçš„DefaultModelLoaderä¸­çš„load_modelåŠ è½½æ¨¡åž‹â€Œï¼Œå¹¶ä½¿ç”¨initialize_modelï¼ˆï¼‰å‡½æ•°åˆå§‹åŒ–æ¨¡åž‹&#xa;æŽ¨ç†æ‰§è¡Œâ€Œï¼š&#xa;Executorçš„execute_model()Â â†’ Workerçš„model_runner.run_model()Â â†’Â model_executoræ‰§è¡Œå‰å‘ä¼ æ’­å¹¶ç®¡ç†KV Cacheâ€Œã€‚" style="rounded=0;whiteSpace=wrap;html=1;dashed=1;dashPattern=8 8;align=left;" vertex="1" parent="1">
          <mxGeometry x="1040" y="820" width="320" height="180" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-14" value="&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;í ¼í¿—ï¸ Qwen2.5-VL æ¨¡åž‹æž¶æž„è¯¦ç»†åˆ†æž&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;í ½í³‹ æ¨¡åž‹é…ç½®æ¦‚è§ˆ:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;æ¨¡åž‹ç±»åž‹: qwen2_5_vl&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;æž¶æž„: [&#39;Qwen2_5_VLForConditionalGeneration&#39;]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;éšè—å±‚å¤§å°: 3584&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;æ³¨æ„åŠ›å¤´æ•°: 28&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;KVå¤´æ•°: 4&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;éšè—å±‚æ•°: 28&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;ä¸­é—´å±‚å¤§å°: 18944&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;è¯æ±‡è¡¨å¤§å°: 152064&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;æœ€å¤§ä½ç½®åµŒå…¥: 128000&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;í ½í±ï¸ è§†è§‰ç¼–ç å™¨é…ç½®:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;éšè—å¤§å°: 1280&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;è¾“å…¥é€šé“: 3&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;ç©ºé—´Patchå¤§å°: 14&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;æ¯ç§’Tokenæ•°: 2&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;âš–ï¸ é‡åŒ–é…ç½®:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;é‡åŒ–æ–¹æ³•: awq&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;æ¯”ç‰¹æ•°: 4&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;ç»„å¤§å°: 128&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;ä¸è½¬æ¢æ¨¡å—: [&#39;visual&#39;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;í ½í´¤ ç‰¹æ®ŠToken ID:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;å›¾åƒToken: 151655&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;è§†é¢‘Token: 151656&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;è§†è§‰å¼€å§‹Token: 151652&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;è§†è§‰ç»“æŸToken: 151653&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;EOS Token: 151645&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;í ½í´ ä»Žæºç åˆ†æžæž¶æž„:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;ä¸»æ¨¡åž‹ç±»: Qwen2_5_VLForConditionalGeneration&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â””â”€ visual: Qwen2_5_VisionTransformer&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ patch_embed: Qwen2_5_VisionPatchEmbed&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ rotary_pos_emb: Qwen2_5_VisionRotaryEmbedding&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ blocks: List[Qwen2_5_VisionBlock]&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; â”œâ”€ norm1: RMSNorm&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; â”œâ”€ attn: Qwen2_5_VisionAttention&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; â”‚&amp;nbsp; â”œâ”€ qkv: QKVParallelLinear&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; â”‚&amp;nbsp; â””â”€ proj: RowParallelLinear&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; â”œâ”€ norm2: RMSNorm&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; â””â”€ mlp: Qwen2_5_VisionMLP&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; &amp;nbsp; &amp;nbsp;â”œâ”€ gate_proj: ColumnParallelLinear&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; &amp;nbsp; &amp;nbsp;â”œâ”€ up_proj: ColumnParallelLinear&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”‚&amp;nbsp; &amp;nbsp; &amp;nbsp;â””â”€ down_proj: RowParallelLinear&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â””â”€ merger: Qwen2_5_VisionPatchMerger&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â””â”€ language_model: Qwen2ForCausalLM&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="1800" y="230" width="370" height="720" as="geometry" />
        </mxCell>
        <mxCell id="mGCUkn8bLk5gTM7kcdC7-15" value="&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;í ¼í¾¯ æ³¨æ„åŠ›æœºåˆ¶è¯¦è§£:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;è§†è§‰æ³¨æ„åŠ› (Qwen2_5_VisionAttention):&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ æ”¯æŒçš„åŽç«¯: Flash Attention, Torch SDPA, xFormers&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ å¼ é‡å¹¶è¡Œæ”¯æŒ: âœ…&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ æ—‹è½¬ä½ç½®ç¼–ç : âœ… (è§†è§‰ç‰¹åŒ–ç‰ˆæœ¬)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ å˜é•¿åºåˆ—æ”¯æŒ: âœ… (cu_seqlens)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â””â”€ çª—å£æ³¨æ„åŠ›: âœ… (éƒ¨åˆ†å±‚ä½¿ç”¨)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;í ½í´„ æ•°æ®æµç¨‹:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;1. è¾“å…¥:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ å›¾åƒ: pixel_values -&amp;gt; Patch Embedding&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ è§†é¢‘: pixel_values_videos -&amp;gt; Patch Embedding&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â””â”€ æ–‡æœ¬: input_ids -&amp;gt; Token Embedding&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;2. è§†è§‰å¤„ç†:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ Patch Embedding (3D Conv)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ ä½ç½®ç¼–ç  (RoPE)&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ Vision Transformer Blocks&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â””â”€ Patch Merger -&amp;gt; è¯­è¨€æ¨¡åž‹ç»´åº¦&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;3. å¤šæ¨¡æ€èžåˆ:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â”œâ”€ è§†è§‰ç‰¹å¾åµŒå…¥åˆ°æ–‡æœ¬åºåˆ—&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â””â”€ ç»Ÿä¸€çš„è¯­è¨€æ¨¡åž‹å¤„ç†&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;4. è¾“å‡ºç”Ÿæˆ:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; â””â”€ è¯­è¨€æ¨¡åž‹ -&amp;gt; Logits -&amp;gt; é‡‡æ ·&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;í ½í³š ä»£ç ç»“æž„åˆ†æž:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;ä¸»è¦ç»„ä»¶ç±»:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ Qwen2_5_VLForConditionalGeneration&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ Qwen2_5_VisionTransformer&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ Qwen2_5_VisionAttention&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ Qwen2_5_VisionBlock&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;å…³é”®æ–¹æ³•:&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ forward(): å‰å‘ä¼ æ’­&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ get_multimodal_embeddings(): å¤šæ¨¡æ€åµŒå…¥&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â”œâ”€ get_input_embeddings(): è¾“å…¥åµŒå…¥&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp;â””â”€ compute_logits(): è®¡ç®—è¾“å‡ºæ¦‚çŽ‡&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2140" y="262.5" width="370" height="550" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
